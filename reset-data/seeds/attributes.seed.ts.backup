import { PrismaClient } from "@prisma/client";

export async function seedAttributes(prisma: PrismaClient) {
  console.log("üé® Creating Product Attributes...");

  // L·∫•y t·∫•t c·∫£ danh m·ª•c con (c√≥ parentId)
  const subcategories = await prisma.category.findMany({
    where: {
      parentId: { not: null },
    },
  });

  // T·∫•t c·∫£ danh m·ª•c con
  const allSubcatIds = subcategories.map((c) => c.id);
  
  // Danh m·ª•c con c√≥ gi√†y
  const giaySubcatIds = subcategories.filter((c) => 
    c.slug?.includes("giay")
  ).map((c) => c.id);

  // ALL SUBCATEGORIES - M√†u s·∫Øc
  await prisma.productAttribute.create({
    data: {
      id: "attr-mau-sac",
      name: "M√†u s·∫Øc",
      code: "mau-sac",
      type: "color",
      values: [
        "ƒêen",
        "Tr·∫Øng",
        "ƒê·ªè",
        "Xanh d∆∞∆°ng",
        "Xanh l√°",
        "V√†ng",
        "Cam",
        "T√≠m",
        "H·ªìng",
        "X√°m",
        "N√¢u",
        "Be",
      ],
      categoryIds: allSubcatIds,
      categories: {
        connect: allSubcatIds.map((id) => ({ id })),
      },
    },
  });

  // Gi√†y subcategories - Size gi√†y
  await prisma.productAttribute.create({
    data: {
      id: "attr-size-giay",
      name: "Size gi√†y",
      code: "size-giay",
      type: "size",
      values: ["36", "37", "38", "39", "40", "41", "42", "43", "44", "45"],
      categoryIds: giaySubcatIds,
      categories: {
        connect: giaySubcatIds.map((id) => ({ id })),
      },
    },
  });

  // Gi√†y subcategories - Size gi√†y
  await prisma.productAttribute.create({
    data: {
      id: "attr-size-giay",
      name: "Size gi√†y",
      code: "size-giay",
      type: "size",
      values: ["36", "37", "38", "39", "40", "41", "42", "43", "44", "45"],
      categoryIds: giaySubcatIds,
      categories: {
        connect: giaySubcatIds.map((id) => ({ id })),
      },
    },
  });

  // ALL SUBCATEGORIES - Size √°o
  await prisma.productAttribute.create({
    data: {
      id: "attr-size-ao",
      name: "Size √°o",
      code: "size-ao",
      type: "size",
      values: ["XS", "S", "M", "L", "XL", "XXL"],
      categoryIds: allSubcatIds,
      categories: {
        connect: allSubcatIds.map((id) => ({ id })),
      },
    },
  });

  // ALL SUBCATEGORIES - Size qu·∫ßn
  await prisma.productAttribute.create({
    data: {
      id: "attr-size-quan",
      name: "Size qu·∫ßn",
      code: "size-quan",
      type: "size",
      values: ["XS", "S", "M", "L", "XL", "XXL"],
      categoryIds: allSubcatIds,
      categories: {
        connect: allSubcatIds.map((id) => ({ id })),
      },
    },
  });

  // ALL SUBCATEGORIES - Size qu·∫ßn
  await prisma.productAttribute.create({
    data: {
      id: "attr-size-quan",
      name: "Size qu·∫ßn",
      code: "size-quan",
      type: "size",
      values: ["XS", "S", "M", "L", "XL", "XXL"],
      categoryIds: allSubcatIds,
      categories: {
        connect: allSubcatIds.map((id) => ({ id })),
      },
    },
  });

  // Ch·∫•t li·ªáu gi√†y - cho danh m·ª•c gi√†y
  await prisma.productAttribute.create({
    data: {
      id: "attr-chat-lieu-giay",
      name: "Ch·∫•t li·ªáu gi√†y",
      code: "chat-lieu-giay",
      type: "text",
      values: [
        "Da th·∫≠t",
        "Da t·ªïng h·ª£p",
        "V·∫£i mesh",
        "V·∫£i canvas",
        "Flyknit",
        "Primeknit",
      ],
      categoryIds: giaySubcatIds,
      categories: {
        connect: giaySubcatIds.map((id) => ({ id })),
      },
    },
  });

  // Ch·∫•t li·ªáu √°o qu·∫ßn - t·∫•t c·∫£ subcategories
  await prisma.productAttribute.create({
    data: {
      id: "attr-chat-lieu-ao-quan",
      name: "Ch·∫•t li·ªáu √°o/qu·∫ßn",
      code: "chat-lieu-ao-quan",
      type: "text",
      values: [
        "Cotton",
        "Polyester",
        "Nylon",
        "Spandex",
        "Dri-FIT",
        "Climacool",
        "Coolmax",
      ],
      categoryIds: allSubcatIds,
      categories: {
        connect: allSubcatIds.map((id) => ({ id })),
      },
    },
  });

  // Ch·∫•t li·ªáu √°o qu·∫ßn - t·∫•t c·∫£ subcategories
  await prisma.productAttribute.create({
    data: {
      id: "attr-chat-lieu-ao-quan",
      name: "Ch·∫•t li·ªáu √°o/qu·∫ßn",
      code: "chat-lieu-ao-quan",
      type: "text",
      values: [
        "Cotton",
        "Polyester",
        "Nylon",
        "Spandex",
        "Dri-FIT",
        "Climacool",
        "Coolmax",
      ],
      categoryIds: allSubcatIds,
      categories: {
        connect: allSubcatIds.map((id) => ({ id })),
      },
    },
  });

  // C√¥ng ngh·ªá ƒë·∫ø gi√†y - cho danh m·ª•c gi√†y
  await prisma.productAttribute.create({
    data: {
      id: "attr-cong-nghe-de",
      name: "C√¥ng ngh·ªá ƒë·∫ø",
      code: "cong-nghe-de",
      type: "text",
      values: [
        "Nike Zoom Air",
        "Nike React",
        "Adidas Boost",
        "Adidas Bounce",
        "Puma NITRO",
        "Asics GEL",
        "Mizuno Wave",
      ],
      categoryIds: giaySubcatIds,
      categories: {
        connect: giaySubcatIds.map((id) => ({ id })),
      },
    },
  });

  // Lo·∫°i ƒë·∫ø gi√†y b√≥ng ƒë√° - ch·ªâ cho gi√†y b√≥ng ƒë√°
  const giayBongDaId = subcategories.find((c) => c.id === "cat-bd-giay")?.id;
  if (giayBongDaId) {
    await prisma.productAttribute.create({
      data: {
        id: "attr-loai-de-bong-da",
        name: "Lo·∫°i ƒë·∫ø b√≥ng ƒë√°",
        code: "loai-de-bong-da",
        type: "text",
        values: [
          "FG (Firm Ground)",
          "AG (Artificial Ground)",
          "SG (Soft Ground)",
          "TF (Turf)",
          "IC (Indoor Court)",
        ],
        categoryIds: [giayBongDaId],
        categories: {
          connect: [{ id: giayBongDaId }],
        },
      },
    });
  }

  // Ki·ªÉu c·ªï gi√†y - cho danh m·ª•c gi√†y
  await prisma.productAttribute.create({
    data: {
      id: "attr-kieu-co-giay",
      name: "Ki·ªÉu c·ªï gi√†y",
      code: "kieu-co-giay",
      type: "text",
      values: ["C·ªï th·∫•p", "C·ªï cao", "C·ªï v·ª´a"],
      categoryIds: giaySubcatIds,
      categories: {
        connect: giaySubcatIds.map((id) => ({ id })),
      },
    },
  });

  // Gi·ªõi t√≠nh - t·∫•t c·∫£ subcategories
  await prisma.productAttribute.create({
    data: {
      id: "attr-gioi-tinh",
      name: "Gi·ªõi t√≠nh",
      code: "gioi-tinh",
      type: "text",
      values: ["Nam", "N·ªØ", "Unisex"],
      categoryIds: allSubcatIds,
      categories: {
        connect: allSubcatIds.map((id) => ({ id })),
      },
    },
  });

  // ƒê·ªô ƒë·ªám - cho c√°c gi√†y th·ªÉ thao (kh√¥ng bao g·ªìm b√≥ng ƒë√°)
  const giayThethaoSubcatIds = subcategories.filter((c) => 
    c.slug?.includes("giay") && 
    !c.slug.includes("bong-da")
  ).map((c) => c.id);

  if (giayThethaoSubcatIds.length > 0) {
    await prisma.productAttribute.create({
      data: {
        id: "attr-do-dem",
        name: "ƒê·ªô ƒë·ªám",
        code: "do-dem",
        type: "text",
        values: ["Th·∫•p", "Trung b√¨nh", "Cao", "T·ªëi ƒëa"],
        categoryIds: giayThethaoSubcatIds,
        categories: {
          connect: giayThethaoSubcatIds.map((id) => ({ id })),
        },
      },
    });
  }

  // Tr·ªçng l∆∞·ª£ng - cho danh m·ª•c gi√†y
  await prisma.productAttribute.create({
    data: {
      id: "attr-trong-luong",
      name: "Tr·ªçng l∆∞·ª£ng",
      code: "trong-luong",
      type: "text",
      values: ["Nh·∫π (< 250g)", "Trung b√¨nh (250-350g)", "N·∫∑ng (> 350g)"],
      categoryIds: giaySubcatIds,
      categories: {
        connect: giaySubcatIds.map((id) => ({ id })),
      },
    },
  });

  // Ki·ªÉu √°o - t·∫•t c·∫£ subcategories
  await prisma.productAttribute.create({
    data: {
      id: "attr-kieu-ao",
      name: "Ki·ªÉu √°o",
      code: "kieu-ao",
      type: "text",
      values: [
        "√Åo thun",
        "√Åo polo",
        "√Åo ba l·ªó",
        "√Åo d√†i tay",
        "√Åo hoodie",
        "√Åo kho√°c",
      ],
      categoryIds: allSubcatIds,
      categories: {
        connect: allSubcatIds.map((id) => ({ id })),
      },
    },
  });

  // Ki·ªÉu qu·∫ßn - t·∫•t c·∫£ subcategories
  await prisma.productAttribute.create({
    data: {
      id: "attr-kieu-quan",
      name: "Ki·ªÉu qu·∫ßn",
      code: "kieu-quan",
      type: "text",
      values: [
        "Qu·∫ßn short",
        "Qu·∫ßn d√†i",
        "Qu·∫ßn l·ª≠ng",
        "Qu·∫ßn jogger",
        "Qu·∫ßn tights",
      ],
      categoryIds: allSubcatIds,
      categories: {
        connect: allSubcatIds.map((id) => ({ id })),
      },
    },
  });

  console.log("‚úÖ Created 14 product attributes for subcategories only");
}
